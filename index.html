<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Crypto para Contrarians</title>
    <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABlBMVEUAAAD///+l2Z/dAAAAD0lEQVR42mNgGAXDEFlQEAEqGwB+UgFeRhsaaaaGAAAAAElFTkSuQmCC" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { 
            background: #000; 
            color: #d4af37; 
            font-family: 'Montserrat', sans-serif; 
            font-weight: 400;
            margin: 0; 
            padding: 0;
            min-height: 100vh;
        }
        header { 
            background: linear-gradient(to bottom, rgba(212,175,55,0.05), transparent);
            text-align: center; 
            padding: 60px 20px 40px;
            border-bottom: 1px solid rgba(212,175,55,0.1);
        }
        .logo { 
            font-size: 80px; 
            font-weight: 800; 
            letter-spacing: 10px; 
            text-shadow: 0 0 20px rgba(212,175,55,0.4);
        }
        .subtitle { 
            font-size: 26px; 
            font-weight: 500;
            margin-top: 15px; 
            opacity: 0.9; 
            letter-spacing: 2px;
        }
        h1 { 
            text-align: center; 
            margin: 50px 0 30px; 
            font-weight: 700;
            font-size: 36px;
            letter-spacing: 3px;
        }
        h2 {
            text-align: center;
            font-weight: 600;
            margin-bottom: 20px;
            letter-spacing: 1px;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 20px; }
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); 
            gap: 30px; 
        }
        .card { 
            background: rgba(17,17,17,0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(212,175,55,0.2);
            border-radius: 16px; 
            padding: 30px; 
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(212,175,55,0.1);
        }
        .value { 
            font-size: 40px; 
            font-weight: 800; 
            margin: 10px 0;
        }
        .label { 
            font-size: 18px; 
            opacity: 0.8; 
            font-weight: 500;
            letter-spacing: 1px;
        }
        canvas { 
            background: rgba(0,0,0,0.3); 
            border-radius: 12px; 
            padding: 10px;
        }
        footer { 
            text-align: center; 
            padding: 60px; 
            opacity: 0.6; 
            font-size: 14px; 
            font-weight: 500;
        }
        #last-update { 
            text-align: center; 
            margin: 40px 0; 
            font-style: italic; 
            font-weight: 600;
            font-size: 18px;
            opacity: 0.9;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card { animation: fadeIn 0.8s ease-out; }
    </style>
<link type="text/css" rel="stylesheet" href="css/style.css"/>
</head>
<body>
    <header>
        <div class="logo">AV</div>
        <div class="subtitle">Anastasia Volkova<br>Clarity in the crypto chaos</div>
    </header>
    
    <h1>Panel Crypto para Contrarians</h1>
    
    <div id="last-update">Última actualización: cargando...</div>
    
    <div class="container">
        <div class="grid">
            <div class="card">
                <div class="label">Precio actual BTC</div>
                <div id="btc-price" class="value">—</div>
            </div>
            <div class="card">
                <div class="label">Capitalización de mercado</div>
                <div id="market-cap" class="value">—</div>
            </div>
            <div class="card">
                <div class="label">Índice de Miedo y Codicia</div>
                <div id="fear-greed-value" class="value">—</div>
                <div id="fear-greed-class" style="margin-top:10px; font-weight:600; font-size:20px;"></div>
            </div>
        </div>
        
        <div class="grid" style="margin-top:60px;">
            <div class="card">
                <h2>Cotización de BTC (Últimos 7 Días)</h2>
                <canvas id="priceChart"></canvas>
            </div>
            <div class="card">
                <h2>Capitalización de Mercado (Últimos 7 Días)</h2>
                <canvas id="marketCapChart"></canvas>
            </div>
        </div>
        
        <div class="grid" style="margin-top:60px;">
            <div class="card">
                <h2>Sentimiento Comunitario (Tendencia F&G 7 Días)</h2>
                <canvas id="fearGreedChart"></canvas>
            </div>
            <div class="card">
                <h2>Volumen (On-Balance Volume - OBV)</h2>
                <canvas id="obvChart"></canvas>
            </div>
        </div>
    </div>
    
    <footer>
        Copyright © <span id="year"></span> Anastasia Volkova
    </footer>

    <script>
        document.getElementById('year').textContent = new Date().getFullYear();

        let priceChart, marketCapChart, fearGreedChart, obvChart;

        function calculateOBV(prices, volumes) {
            let obv = [0];
            for (let i = 1; i < prices.length; i++) {
                if (prices[i] > prices[i-1]) obv.push(obv[i-1] + volumes[i]);
                else if (prices[i] < prices[i-1]) obv.push(obv[i-1] - volumes[i]);
                else obv.push(obv[i-1]);
            }
            return obv;
        }

        const gold = '#d4af37';
        const goldGradient = (ctx) => {
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(212,175,55,0.3)');
            gradient.addColorStop(1, 'rgba(212,175,55,0)');
            return gradient;
        };

        async function updateData() {
            try {
                const gecko = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=7&interval=daily').then(r => r.json());
                const current = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_market_cap=true').then(r => r.json());

                const prices = gecko.prices.map(p => p[1]);
                const marketCaps = gecko.market_caps.map(m => m[1]);
                const volumes = gecko.total_volumes.map(v => v[1]);
                const dates = gecko.prices.map(p => new Date(p[0]).toLocaleDateString('es-ES'));

                const fgResponse = await fetch('https://api.alternative.me/fng/?limit=8&format=json').then(r => r.json());
                const fgCurrent = fgResponse.data[0];
                const fgHistory = fgResponse.data.slice(0,8).reverse();

                document.getElementById('btc-price').textContent = '$' + current.bitcoin.usd.toLocaleString('es-ES');
                document.getElementById('market-cap').textContent = '$' + (current.bitcoin.usd_market_cap / 1e9).toFixed(2) + 'B';
                document.getElementById('fear-greed-value').textContent = fgCurrent.value;
                document.getElementById('fear-greed-class').textContent = fgCurrent.value_classification;

                // Gráficos premium
                const commonOptions = {
                    responsive: true,
                    plugins: { legend: { labels: { color: gold, font: { family: 'Montserrat', weight: 600 } } } },
                    scales: { y: { ticks: { color: gold }, grid: { color: 'rgba(212,175,55,0.1)' } }, x: { ticks: { color: gold }, grid: { color: 'rgba(212,175,55,0.1)' } } },
                    elements: { line: { tension: 0.4, borderWidth: 3 }, point: { radius: 4, hoverRadius: 8 } }
                };

                if (priceChart) priceChart.destroy();
                priceChart = new Chart(document.getElementById('priceChart'), {
                    type: 'line',
                    data: { labels: dates, datasets: [{ label: 'Precio BTC (USD)', data: prices, borderColor: gold, backgroundColor: goldGradient, fill: true }] },
                    options: commonOptions
                });

                if (marketCapChart) marketCapChart.destroy();
                marketCapChart = new Chart(document.getElementById('marketCapChart'), {
                    type: 'line',
                    data: { labels: dates, datasets: [{ label: 'Cap. Mercado (B USD)', data: marketCaps.map(m => (m / 1e9).toFixed(2)), borderColor: gold, backgroundColor: goldGradient, fill: true }] },
                    options: commonOptions
                });

                if (fearGreedChart) fearGreedChart.destroy();
                fearGreedChart = new Chart(document.getElementById('fearGreedChart'), {
                    type: 'line',
                    data: { labels: fgHistory.map(d => new Date(d.timestamp * 1000).toLocaleDateString('es-ES')), datasets: [{ label: 'Índice F&G', data: fgHistory.map(d => d.value), borderColor: gold, backgroundColor: goldGradient, fill: true }] },
                    options: { ...commonOptions, scales: { ...commonOptions.scales, y: { min: 0, max: 100, ticks: { color: gold } } } }
                });

                const obv = calculateOBV(prices, volumes);
                if (obvChart) obvChart.destroy();
                obvChart = new Chart(document.getElementById('obvChart'), {
                    type: 'line',
                    data: { labels: dates, datasets: [{ label: 'OBV', data: obv, borderColor: gold, backgroundColor: goldGradient, fill: true }] },
                    options: commonOptions
                });

                document.getElementById('last-update').textContent = 'Última actualización: ' + new Date().toLocaleString('es-ES');
            } catch (e) {
                console.error(e);
                document.getElementById('last-update').textContent = 'Error al cargar datos. Reintentando...';
            }
        }

        updateData();
        setInterval(updateData, 60000);
    </script>
<script type="text/javascript" src="js/script.js"></script>
</body>
</html>